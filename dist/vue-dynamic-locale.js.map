{"version":3,"sources":["webpack://VueDynamicLocale/webpack/universalModuleDefinition","webpack://VueDynamicLocale/webpack/bootstrap","webpack://VueDynamicLocale/./src/LocaleStore.js","webpack://VueDynamicLocale/./src/VueDynamicLocale.js","webpack://VueDynamicLocale/./src/index.js","webpack://VueDynamicLocale/external \"fs\"","webpack://VueDynamicLocale/external \"js-objectex\""],"names":["FormatTranslations","raw","rawTranslations","JSON","parse","flat","RawTree","Flat","RawMap","DoubleMap","value","key","endsWith","substr","length","LoadTranslations","locale","localePath","languageFile","Promise","resolve","reject","fs","existsSync","readFile","err","data","Error","CreateStore","path","LOCALE_PATH","state","translations","mutations","SET","SET_TRANSLATIONS","actions","commit","then","namespaced","VueDynamicLocale","install","Vue","store","defaultLocale","registerModule","dispatch","prototype","$setLocale","$store","$getLocales","candidates","readdirSync","filter","c","toLowerCase","map","mixin","computed","$t"],"mappings":"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","file":"vue-dynamic-locale.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"js-objectex\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"js-objectex\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VueDynamicLocale\"] = factory(require(\"js-objectex\"));\n\telse\n\t\troot[\"VueDynamicLocale\"] = factory(root[\"js-objectex\"]);\n})(global, function(__WEBPACK_EXTERNAL_MODULE_js_objectex__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import fs from 'fs'\nimport { RawTree, RawMap } from 'js-objectex'\n\nfunction FormatTranslations (raw) {\n  let rawTranslations = JSON.parse(raw)\n  let flat = RawTree.Flat(rawTranslations, '', '.')\n  return RawMap.DoubleMap(flat, (value, key) => ({\n    key: key.endsWith('..') ? key.substr(0, key.length - 2) : key,\n    value\n  }))\n}\n\nfunction LoadTranslations (locale, localePath) {\n  let languageFile = `${localePath}/${locale}.json`\n  return new Promise((resolve, reject) => {\n    if (fs.existsSync(languageFile)) {\n      fs.readFile(languageFile, 'utf-8', (err, data) => {\n        if (err) {\n          reject(err)\n        } else {\n          resolve(data)\n        }\n      })\n    } else {\n      reject(new Error('404'))\n    }\n  })\n}\n\nfunction CreateStore (path) {\n  const LOCALE_PATH = path\n\n  const state = {\n    locale: '',\n    translations: {}\n  }\n\n  const mutations = {\n    SET (state, locale) {\n      state.locale = locale\n    },\n\n    SET_TRANSLATIONS (state, translations) {\n      state.translations = translations\n    }\n  }\n\n  const actions = {\n    SET ({ state, commit }, locale) {\n      LoadTranslations(locale, LOCALE_PATH).then(data => {\n        commit('SET', locale)\n        commit('SET_TRANSLATIONS', FormatTranslations(data))\n      })\n    }\n  }\n\n  return {\n    namespaced: true,\n    state,\n    mutations,\n    actions\n  }\n}\n\nexport default CreateStore\n","import fs from 'fs'\nimport CreateStore from './LocaleStore'\n\nconst VueDynamicLocale = {\n  install (Vue, { store, path, defaultLocale }) {\n    path = path || 'static/locale'\n    defaultLocale = defaultLocale || 'en'\n\n    store.registerModule('locale', CreateStore(path))\n    store.dispatch('locale/SET', defaultLocale)\n\n    Vue.prototype.$setLocale = function (locale) {\n      this.$store.dispatch('locale/SET', locale)\n    }\n\n    Vue.prototype.$getLocales = function () {\n      let candidates = fs.readdirSync(path)\n      return candidates.filter(c => c.substr(c.length - 5).toLowerCase() === '.json').map(c => c.substr(0, c.length - 5))\n    }\n\n    Vue.mixin({\n      computed: {\n        $t () {\n          return this.$store.state.locale.translations\n        }\n      }\n    })\n  }\n}\n\nexport default VueDynamicLocale\n","import VueDynamicLocale from './VueDynamicLocale'\nexport default VueDynamicLocale\n","module.exports = require(\"fs\");","module.exports = __WEBPACK_EXTERNAL_MODULE_js_objectex__;"],"sourceRoot":""}